# Week 2：要約統計量

```{=html}
<style>
.infobox {
  padding: 1em 1em 1em 4em;
  margin-bottom: 10px;
  border: 2px solid orange;
  border-radius: 10px;
  background: #f5f5f5 5px center/3em no-repeat;
}

.beg {
  background-image: url("https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjHtu3kBX8P39WYBBAjar9c8c1ladK2SYL6_gEMXFweQfauWVhSvCQP5KELsPX5KNL1uOddLLQ-aeMxv904OW_NFFfANhBYObfBV09KO2EXehrb9kMdCLZY1afsChib-7zIkBJbG6OrbJpM/s400/aisatsu_kodomo_boy.png");}

.caution {
  background-image: url("https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhzMqkpQ7vLUKvumbm6AFwTLQiCe7tlDb2Q0MAiISLsesZHnhj0kbRjB4U3se3UrDIHfIy0hlahyphenhyphenQu-V2tOR2LcV_lX7U8P5a8jtqPYv3Ah4L-JoYi8PhoaoehumGIdp2vrsX0rRyhXqwA/s800/mark_chuui.png");}
  
</style>
```

## 今日の目標

1. 記述統計、推測統計の違いおよびデータの尺度について理解できる。
2. データの要約統計量やグラフの意味が理解でき、またそれらをRで算出・作成ができる。

## 今日の格言

::: infobox
  プログラムは思った通りには動かない。書いた通りに動くのだ（unknown）
:::

- 前半は主に説明、後半はRを使用して手を動かしながらやってもらいます。

## 記述統計と推測統計

- 誤差！

## データの尺度

- 4種類あり、比例、間隔、順序、名義の順に情報量が少なくなる

  - 上の順序のデータを下の順位のデータに変換することはできるが、逆の変換はできない

### 比率尺度（ratio scale）

- **様々な統計処理に使える**
- 例：長さ、重さ、時間

- ゼロが「何もない」ことを表す

- メモリがすべて等間隔
- データ同士で四則演算ができる

### 間隔尺度（interval scale）

- 例：温度、テストの得点、偏差値、テストの平均点

- メモリの間隔は同じ
- ゼロは「何もない」ことを**表さない**
- 「足す」「引く」は可能。「かける」「わる」はできない。

### 順序尺度（ordinal scale）

- 例：順位、投票のランキング、リカート・スケール（Likert scale）

- 順位のデータ

- メモリの間隔が一定になる保証はない（= 大小のみを指す）。

- 0位もない

- 四則演算ができない

### 名義尺度（nominal scale）

- データに任意の数を与えたデータ

  - 例：男性は1、女性は2
  
- メモリは等間隔でない

- ゼロは「何もない」を表さない

- 四則演算ができない

## 「～とみなす」

- テスト得点は厳密にいうと、間隔尺度とは言えない？

  - 配点が1点と5点は5倍の違いがあるか？
  - 0点は能力が全くないと言えるか？
  
- しかしテスト得点を統計分析したい場面が多く、統計分析は間隔尺度以上のデータを必要とする。

- テスト得点の間隔を等間隔にする努力を怠らないのであれば間隔尺度として「みなそう」ということに現状はなっている（完全に合意されているわけではない）。

  - 本講義ではテスト得点を間隔尺度として「みなす」



## 要約統計量
信頼区間まで説明

## 様々なグラフ
- それぞれがどんなデータを使っているかによって異なることを説明する
ヒストグラム
箱ひげ図
折れ線グラフ
散布図

- (point)
- データを分析する際は、まず要約統計量や可視化を行い、データを注意深く観察する。→ とりあえず××分析などはだめ。それならAIと同じ。ブラックボックス化をできるだけ避ける。


## ハンズオンセッション

### Rの基本用語

#### 変数
- どんなデータも格納できる箱。箱には必ず名前を付ける。**名前は英数字のみを入れること。**また、命名には規則がある。

  - 名前の先頭に数字（e.g., 1hako）や記号（e.g., %hako）は使用できない
  - 大文字と小文字は区別される（Hakoとhakoは別の変数として認識される）
  
::: infobox
プログラミングの世界では、以下の二つの命名の流儀がある。

- スネークケース🐍：変数の区切りを"_"で示す（e.g., snake_case）
- キャメルケース🐫：変数の区切りを大文字で示す（e.g., camelCase）

自由に箱（変数）に名前を付けてよいが、できるだけ自分の中で一貫したルールを持ち、第三者が見ても何が格納されているか分かりやすい名前を付けることを意識する。
:::

- 変数に入れたデータは、［Environment］タブに表示される。

- 変数の中身が数値の場合、数値を足したりかけたりなど計算ができる。

  - numという名前の変数に1から10の数字を入れ、それらを2倍した

```{r}
num <- 1:10

num

num * 2
```

- 変数の中身は上書きすることもできる

```{r}
num <- num * 2
```


#### データの型
- 「いちたすに」と「1 + 2」はコンピュータにとっては別もの

  - 実数型（numeric）：数値全般（e.g., 10.4）
  - 整数型（integer）：整数のみ（e.g., 10）
  - 文字列型（character）：文字（e.g., "十"）。入力する際は```""```や```''```で囲む
  - 論理型（logical）：TRUEとFALSEからなる
  - 因子型（factor）：データに順番（数字を割り振る）

```{r}
dat <- 1:4

str(dat)

dat <- factor(dat, levels = c(4:1))

str(dat)

```

#### 関数
- パッケージに含まれている、命令を実行するのに必要なもの。```data.frame()```のような文字列とかっこの組み合わせ。かっこの中にデータを格納する。
    
    - 数学の関数とイメージしてもよい。例えば、Y\ =\ 2x という関数は、xを2倍する関数。入れたデータが2倍されて返ってくる。

  - 使う際は呼び出す必要があり、Rのセッションが切れるまでは何回も呼び出す必要はない。Rに標準で備わっているものは呼び出す必要はない（base関数という）。
  
    - 下の例では、```plot()```関数で変数の中身を描画している
  
```{r}

dat.2 <- 1:10

plot(dat.2)
```
  - ```help(関数名)```やウェブサイトで調べると、使い方を確認することができる。
  
  
#### ベクトル
- データのまとまり

  - ```c()```関数で作成可能。連続する数値であれば、```:```でもOK

```{r}
numVector1 <- c(1, 35, 90, 0.9)
numVector2 <- c(1, 35, 90, 9)
chVector <- c("いちご", "strawberry", "イチゴ")
numchVector <- c("イチゴ", 1000, "みかん", "500")
```

- 変数に何かを入れたら、必ず中身を確認する！
```{r}
numVector1
numVector2
chVector
numchVector
```
- データの型がどうなっているかを確認。確認する関数は様々なものがある。[Environment]タブでも表示されている。
```{r}
class(numVector1)
str(numVector2)
typeof(chVector)
mode(numchVector)
```
### データを読み込む

- 研究では、ファイルに格納されたデータに対して分析を行う。データ基本的にxlsx、csv、txtという拡張子のファイルに格納されていることが多い（最近ではオンラインでのデータ収集によってJSON形式もよく見るようになりました）。

  - xlsx

    - エクセルファイル。

  - csv (Comma-Separated Values)

    - カンマ（,）で項目を区切ったファイル

  - txt

    - 文字データだけが含まれるファイル（区切りは様々）

- 拡張子を表示させる設定に変更する。

- データを読み込む場合、ファイルの種類によって読み込む際の関数が異なる。リンク先から（[データ格納庫](リンクを挿入)）データをダウンロードし、本講義用のR project内に移動させる。

- 移動させたら、以下のコードを走らせ、データをR(Studio)に読み込む

  - 文字化けする場合、以下のコードを引数の中に加える（Windows: ```挿入```, MAC: ```挿入```）。

- 以下の処理で、csvファイル内のデータを```dat```という変数の中に格納したことになる。

```{markdown}
dat <- read.csv()
```


### データフレーム

- 行（横）と列（縦）からなる、ベクトルのかたまり

  - 数値、文字、因子など様々なベクトルを格納するデータ。データ分析のデータは基本的にこの型を指す。

- 読み込んだデータは基本的にデータフレームであるが、ベクトルから```data.frame()```関数で作成することもできる。  

```{r}
fruit_df <- data.frame(
  name = c("イチゴ", "みかん"),
  price = c(100, 150)
)
```

- 数値は行の番号を指し、データには含まれない。
```{r}
fruit_df
```


### 要約統計量の算出
#### 各統計量ごと


```{r}
# 合計 (sum)
sum(mtcars$mpg)

# 平均 (mean)
mean(mtcars$mpg)

# 中央値 (median)
median(mtcars$mpg)

# 最大値 (max)
max(mtcars$mpg)

# 最小値 (min)
min(mtcars$mpg)

# 標本分散 (var)
var(mtcars$mpg)

# 標本標準偏差 (sd)
sd(mtcars$mpg)

# （最大 - 最小）
range_mpg <- range(mtcars$mpg)
wide_mpg <- diff(range_mpg)
wide_mpg  # 範囲を表示

# 尖度 (kurtosis) ※"moments" パッケージを使用
#install.packages("moments")  # 初回のみ
library(moments)
kurtosis(mtcars$mpg)

# 四分位範囲 (IQR)
IQR(mtcars$mpg)
```
#### 一度に出力
- ```base```関数
```{r}
base::summary(mtcars$mpg)
```

- ```psych```パッケージの```describe```関数
```{r}
# install.packages("psych") 1つのパソコンにつき一回でよい
library(psych) # 使用する際、セッションにつき一回
describe(mtcars$mpg)
```


#### 最頻値

- Rでは最頻値の求め方に少し一工夫必要。いろいろなやり方があるが、その一例として下記がある。

```{r}
# 最頻値 (mode) ※最頻値は複数ある場合があるため table() を使用
table_mpg <- table(mtcars$mpg)
mode_mpg <- as.numeric(names(table_mpg)[table_mpg == max(table_mpg)])
mode_mpg  # 最も頻度の高い値を表示

```


### 作図

- Rに最初から登録されているデータセットを使用

  - [参考](https://www.geeksforgeeks.org/a-complete-guide-to-the-built-in-datasets-in-r/)

- 描画のパラメータ。詳しくはウェブサイトを参考に（[例](https://eau.uijin.com/advgraphs/parameters.html) ）
  - main: 図のタイトル
  - xlab: x軸のタイトル
  - ylab: y軸のタイトル
  - border: ヒストグラムの棒の枠線
  - type: 線や点のスタイル
  - col: 色を指定（e.g.,  "blue", "red", "green"）
  - pch: 点の形指定（e.g.,  pch = 16 は●、pch = 17 は▲）
  - lwd: 線の太さを指定

#### ヒストグラム
```{r}
hist(mtcars$mpg, 
     main = "Histogram of Miles Per Gallon (mpg)", 
     xlab = "Miles Per Gallon", 
     col = "lightblue", 
     border = "black")

```
#### 箱ひげ図

```{r}
boxplot(mtcars$hp, 
        main = "Boxplot of Horsepower", 
        ylab = "Horsepower", 
        col = "lightcoral")

```

#### 折れ線グラフ
```{r}
plot(airquality$Temp, 
     type = "l", 
     main = "Daily Temperature in New York", 
     xlab = "Day", 
     ylab = "Temperature (°F)", 
     col = "blue", 
     lwd = 2)

```
#### 散布図

```{r}
plot(mtcars$wt, mtcars$mpg, 
     main = "Scatter Plot of Car Weight vs. MPG", 
     xlab = "Weight (1000 lbs)", 
     ylab = "Miles Per Gallon", 
     col = "darkgreen", 
     pch = 16)

```





## 次週までの課題

### 提出方法
- メールにファイルを添付して送信。
- 締め切りは今週の木曜日まで

## 参考文献

- 外国語教育ハンドブック
- Rでらくらくデータ分析
- https://www.geeksforgeeks.org/a-complete-guide-to-the-built-in-datasets-in-r/
- https://eau.uijin.com/advgraphs/parameters.html