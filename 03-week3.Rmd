# Week 3ï¼šæ¨æ¸¬çµ±è¨ˆå­¦

```{r, include=FALSE}
library(tidyverse)
library(patchwork)
library(gridExtra)
library(gganimate)
```

## äº‹å‰ã®ç¢ºèª

- ã“ã®è¬›ç¾©ã®Rãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ã„ã¦ã„ã¾ã™ã‹ï¼Ÿ
- è‹±æ•°å­—ã§åå‰ã‚’ä»˜ã‘ãŸæœ¬æ—¥ã®è¬›ç¾©ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸã‹ï¼Ÿ

  - .Rã§ã‚‚.Rmdã§ã‚‚ã©ã¡ã‚‰ã§ã‚‚å¤§ä¸ˆå¤«ã§ã™ã€‚

## ä»Šæ—¥ã®ç›®æ¨™

1. æ¯é›†å›£ã¨æ¨™æœ¬ã®é•ã„ã‚„ç¢ºç‡åˆ†å¸ƒãŒç†è§£ã§ãã‚‹
2. åŒºé–“æ¨å®šã®è€ƒãˆæ–¹ãŒç†è§£ã§ãã‚‹

## æ¯é›†å›£ã¨æ¨™æœ¬
- æ¨æ¸¬çµ±è¨ˆå­¦ã¯ã€**æ¯é›†å›£**ã‹ã‚‰**æ¨™æœ¬**ã‚’å¾—ã¦ã€æ¯é›†å›£ã®ç‰¹å¾´ã‚’æ¨æ¸¬ã™ã‚‹æ‰‹æ³•

```{r, echo=FALSE}
# æ¯é›†å›£ãƒ‡ãƒ¼ã‚¿ï¼ˆæ­£è¦åˆ†å¸ƒã‚’ä»®å®šï¼‰
set.seed(123)
population <- data.frame(value = rnorm(10000, mean = 50, sd = 10))

# æ¨™æœ¬ã‚’æŠ½å‡º
sample_data <- as.data.frame(population[sample(1:10000, 100), ])
colnames(sample_data) <- "value"

# å¯è¦–åŒ–
ggplot() +
  geom_histogram(data = population, aes(x = value), bins = 30, fill = "grey", alpha = 0.5) +
  geom_histogram(data = sample_data, aes(x = value), bins = 30, fill = "blue", alpha = 0.5) +
  labs(title = "æ¯é›†å›£ã¨æ¨™æœ¬ã®æ¦‚å¿µå›³ï¼ˆ100ç‚¹æº€ç‚¹ã®ãƒ†ã‚¹ãƒˆã®ä¾‹ï¼‰", x = "å€¤", y = "é »åº¦",
       subtitle = "ç°è‰²ï¼šæ¯é›†å›£ã€é’è‰²ï¼šæ¨™æœ¬") +
  theme_minimal() + 
  theme(axis.text.y = element_blank())
```

### æ¯é›†å›£ï¼ˆpopulationï¼‰

- èª¿ã¹ãŸã„å¯¾è±¡ã®é›†å›£ã®ã“ã¨
  
  - ä¾‹

    - ç ”ç©¶èª²é¡Œï¼šè‹±èªã‚’ç¬¬äºŒè¨€èªã¨ã—ã¦å­¦ã¶äººã¯æ¯èªã®å½±éŸ¿ã‚’å¿…ãšå—ã‘ã‚‹ã€‚
    
    - æ¯é›†å›£ï¼šä¸–ç•Œä¸­ã®è‹±èªã‚’ç¬¬äºŒè¨€èªã¨ã—ã¦å­¦ã¶äºº

### æ¨™æœ¬ï¼ˆSampleï¼‰
- å®Ÿé¨“ã‚„èª¿æŸ»ã®ãŸã‚ã«æ¯é›†å›£ã®ä¸­ã‹ã‚‰é¸ã°ã‚ŒãŸã‚‚ã®

  - é¸ã¶ã“ã¨ã‚’æ¨™æœ¬æŠ½å‡ºï¼ˆsamplingï¼‰ã¨å‘¼ã¶

## ç¢ºç‡ã¨ç¢ºç‡å¤‰æ•°
- æ¨æ¸¬çµ±è¨ˆå­¦ã§ã¯ç¢ºç‡ãŒéå¸¸ã«é‡è¦ãªæ¦‚å¿µã€‚

### ç¢ºç‡

### ç¢ºç‡å¤‰æ•°ã¨ç¢ºç‡åˆ†å¸ƒ

#### ç¢ºç‡å¤‰æ•°ï¼ˆrandom variableï¼‰
- ç¢ºç‡çš„ã«ç”Ÿã˜ã‚‹äº‹è±¡ã«æ•°å€¤ã‚’å‰²ã‚Šå½“ã¦ãŸã‚‚ã®

  - å®Ÿéš›ã«å¾—ã‚‰ã‚ŒãŸå€¤ã®ã“ã¨ã‚’ç¢ºç‡å¤‰æ•°ã®**å®Ÿç¾å€¤**ã¨ã„ã†
  
- ç¢ºç‡å¤‰æ•°ã¯ã‚¹ãƒ­ãƒƒãƒˆãƒã‚·ãƒ¼ãƒ³ãŒå›ã£ã¦ã„ã‚‹çŠ¶æ…‹ã€‚å®Ÿç¾å€¤ã¯ã‚¹ãƒ­ãƒƒãƒˆãƒã‚·ãƒ¼ãƒ³ãŒæ­¢ã¾ã£ã¦å€¤ãŒå®šã¾ã£ãŸçŠ¶æ…‹ã‚’ã‚¤ãƒ¡ãƒ¼ã‚¸ã™ã‚‹ã¨ã‚ˆã„

```{r, include = F}
set.seed(123)
df <- expand.grid(frame = 1:7, slot = factor(1:3)) %>%
  mutate(value = sample(1:7, n(), replace = TRUE))  # 1-7ã®ãƒ©ãƒ³ãƒ€ãƒ å€¤

# ã‚¹ãƒ­ãƒƒãƒˆãƒã‚·ãƒ³ã®å›è»¢ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
p<- ggplot(df, aes(x = slot, y = 1, label = value)) +
  geom_text(size = 15, fontface = "bold", color = "skyblue") +
  ylim(0.5, 1.5) +
  theme_minimal() +
  theme(
    axis.title = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank()
  ) +
  ggtitle("ã‚¹ãƒ­ãƒƒãƒˆãƒã‚·ãƒ³") +
  gganimate::transition_states(frame, transition_length = 1, state_length = 0.5) +
  gganimate::enter_fade() + 
  gganimate::exit_fade()

p
```

#### ç¢ºç‡åˆ†å¸ƒï¼ˆprobability distributionï¼‰
- ç¢ºç‡å¤‰æ•°ã®å®Ÿç¾å€¤ãã‚Œãã‚Œã®ç”Ÿã˜ã‚„ã™ã•ã‚’ç¢ºç‡ã§è¡¨ã—ãŸã‚‚ã®ã€‚çµ±è¨ˆå­¦ã§ã¯ã€ç¢ºç‡å¤‰æ•°ã®å®Ÿç¾å€¤ã‚’ä¸ãˆã‚‹ã¨ç¢ºç‡ã‚’è¿”ã™é–¢æ•°ã®ã“ã¨ã‚’ç¢ºç‡åˆ†å¸ƒã¨ã„ã†

- äº‹è±¡ã‚’ç¢ºç‡å¤‰æ•°ã¨ã—ã¦æ‰±ã†ã“ã¨ã§ã€æ¯é›†å›£ã‚’äººã®é›†å›£ã§ã¯ãªãã€ç¢ºç‡å¤‰æ•°ã®å®Ÿç¾å€¤ã®é›†åˆã¨ã—ã¦è€ƒãˆã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚

  - 1ä¸‡äººã®å­¦ç”Ÿã®é›†å›£ã¨ã„ã†æ¯é›†å›£ãŒã€æ•°å€¤ãŒ1ä¸‡å€‹ã‚ã‚‹é›†å›£ã¨ä»®å®šã§ãã€æ•°å­¦çš„ãªæ çµ„ã¿ã¨ã—ã¦è€ƒãˆã‚„ã™ããªã‚‹ï¼ˆæ•°å­¦ã®ä¸–ç•Œã«ç¾å®Ÿä¸–ç•Œã‚’æ˜ ã™ï¼‰ã€‚

- ã“ã®å ´åˆã€æ¯é›†å›£ã®æ€§è³ªã‚’æ¨™æœ¬ã«æ­£ç¢ºã«åæ˜ ã•ã›ã‚‹ãŸã‚ã«ã€**å˜ç´”ç„¡ä½œç‚ºæŠ½å‡ºï¼ˆsimple random samplingï¼‰**ã‚’è¡Œã†å¿…è¦ãŒã‚ã‚‹ã€‚

  - æ¯é›†å›£ã®ã™ã¹ã¦ã®å¯¾è±¡ãŒåã‚Šãªãé¸ã°ã‚Œã‚‹ã“ã¨ï¼ˆ= ç„¡ä½œç‚ºã«é¸ã¶ï¼‰

#### ç¢ºç‡åˆ†å¸ƒã®ç¨®é¡
- é›¢æ•£å‹ç¢ºç‡åˆ†å¸ƒï¼šç¢ºç‡è³ªé‡é–¢æ•°
  - ã¨ã³ã¨ã³ã®å€¤ã‚’ã¨ã‚‹ï¼ˆe.g., è£ã€è¡¨ï¼‰
  - ãƒ™ãƒ«ãƒŒãƒ¼ã‚¤åˆ†å¸ƒã€äºŒé …åˆ†å¸ƒã€ãƒã‚¢ã‚½ãƒ³åˆ†å¸ƒ

```{r, echo=FALSE}
# ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
# ãƒ™ãƒ«ãƒŒãƒ¼ã‚¤åˆ†å¸ƒ (æˆåŠŸç¢ºç‡ p = 0.5)
bernoulli <- data.frame(x = 0:1, y = dbinom(0:1, size = 1, prob = 0.7))

# äºŒé …åˆ†å¸ƒ (n = 10, p = 0.5)
binomial <- data.frame(x = 0:10, y = dbinom(0:10, size = 10, prob = 0.5))

# ãƒã‚¢ã‚½ãƒ³åˆ†å¸ƒ (Î» = 3)
poisson <- data.frame(x = 0:10, y = dpois(0:10, lambda = 3))

# ãƒ™ãƒ«ãƒŒãƒ¼ã‚¤åˆ†å¸ƒã€äºŒé …åˆ†å¸ƒã€ãƒã‚¢ã‚½ãƒ³åˆ†å¸ƒã‚’ãã‚Œãã‚Œãƒ—ãƒ­ãƒƒãƒˆ
p1 <- ggplot(bernoulli, aes(factor(x), y)) + 
  geom_bar(stat = "identity") + 
  ggtitle("Bernoulli Distribution") +
  theme_minimal()

p2 <- ggplot(binomial, aes(x, y)) + 
  geom_bar(stat = "identity") + 
  ggtitle("Binomial Distribution") +
  theme_minimal() + scale_x_continuous(breaks = 0:10)

p3 <- ggplot(poisson, aes(x, y)) + 
  geom_bar(stat = "identity") + 
  ggtitle("Poisson Distribution") +
  theme_minimal() + scale_x_continuous(breaks = 0:10)

# 3ã¤ã®ãƒ—ãƒ­ãƒƒãƒˆã‚’æ¨ªã«ä¸¦ã¹ã¦è¡¨ç¤º
gridExtra::grid.arrange(p1, p2, p3, ncol = 3)
```


- é€£ç¶šç¢ºç‡åˆ†å¸ƒï¼šç¢ºç‡å¯†åº¦é–¢æ•°
  - é€£ç¶šã—ãŸå€¤ã‚’ã¨ã‚‹ï¼ˆe.g., èº«é•·ï¼‰
  - æ­£è¦åˆ†å¸ƒã€*t* åˆ†å¸ƒã€ã‚«ã‚¤äºŒä¹—åˆ†å¸ƒ

```{r, echo=FALSE}
# æ­£è¦åˆ†å¸ƒ (å¹³å‡ 0, æ¨™æº–åå·® 1)
normal <- data.frame(x = seq(-4, 4, length.out = 100), 
                     y = dnorm(seq(-4, 4, length.out = 100), mean = 0, sd = 1))

# tåˆ†å¸ƒ (è‡ªç”±åº¦ 10)
t_dist <- data.frame(x = seq(-4, 4, length.out = 100), 
                     y = dt(seq(-4, 4, length.out = 100), df = 10))

# ã‚«ã‚¤äºŒä¹—åˆ†å¸ƒ (è‡ªç”±åº¦ 5)
chisq_dist <- data.frame(x = seq(0, 15, length.out = 100), 
                         y = dchisq(seq(0, 15, length.out = 100), df = 5))

# æ­£è¦åˆ†å¸ƒã€tåˆ†å¸ƒã€ã‚«ã‚¤äºŒä¹—åˆ†å¸ƒã‚’ãã‚Œãã‚Œãƒ—ãƒ­ãƒƒãƒˆ
p1 <- ggplot(normal, aes(x, y)) + 
  geom_line() + 
  ggtitle("Normal Distribution") +
  theme_minimal()

p2 <- ggplot(t_dist, aes(x, y)) + 
  geom_line() + 
  ggtitle("t Distribution") +
  theme_minimal()

p3 <- ggplot(chisq_dist, aes(x, y)) + 
  geom_line() + 
  ggtitle("Chi-Square Distribution") +
  theme_minimal()

# 3ã¤ã®ãƒ—ãƒ­ãƒƒãƒˆã‚’æ¨ªã«ä¸¦ã¹ã¦è¡¨ç¤º
grid.arrange(p1, p2, p3, ncol = 3)
```


## æ¨æ¸¬çµ±è¨ˆå­¦ã®è€ƒãˆæ–¹

### æ¨™æœ¬çµ±è¨ˆé‡
- æ¨™æœ¬ã‹ã‚‰è¨ˆç®—ã•ã‚Œã‚‹è¨˜è¿°çµ±è¨ˆé‡ã®ã“ã¨

- **æ¨™æœ¬å¹³å‡**ï¼šæ¯é›†å›£ã‹ã‚‰å¾—ãŸæ¨™æœ¬ã®ãƒ‡ãƒ¼ã‚¿ã®å¹³å‡å€¤
  - **æ¯å¹³å‡**ï¼šæ¯é›†å›£ã®å¹³å‡å€¤

### æ¨™æœ¬åˆ†å¸ƒ

- æ¨™æœ¬çµ±è¨ˆé‡ãŒç¢ºç‡çš„ã«å¤‰å‹•ã™ã‚‹ã“ã¨ã‚’è¡¨ã—ãŸç¢ºç‡åˆ†å¸ƒã®ã“ã¨

  - æ¨™æœ¬ã‚’æ²¢å±±æŠ½å‡ºã—ãŸå ´åˆã§ã‚ã£ã¦ã€1ã¤ã®ãƒ‡ãƒ¼ã‚¿ã®åˆ†å¸ƒã§ã¯ãªã„
  
- æ¨™æœ¬ã‚µã‚¤ã‚ºï¼ˆ *k* ï¼‰ãŒå¤§ãããªã‚‹ã«ã¤ã‚Œã€æ¨™æœ¬åˆ†å¸ƒã®æ•£ã‚‰ã°ã‚Šã¯ã©ã‚“ã©ã‚“å°ã•ããªã‚‹

  - ä»¥ä¸‹ã®å›³ã§ã¯100ã»ã©ã®ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Œã°æ¯å¹³å‡ï¼ˆ0.7ï¼‰ã® Â± 0.1ã«ã»ã¨ã‚“ã©ã®ãƒ‡ãƒ¼ã‚¿ãŒé›†ã¾ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚‹
  
  - ã—ã‹ã—ã€ã“ã‚Œã¯æ¯å¹³å‡ã‚’äº‹å‰ã«æŠŠæ¡ã—ã¦ã„ã‚‹å ´åˆã‚’ä¾‹ã§ã‚ã‚Šã€äº‹å‰ã«æ¯å¹³å‡ã‚’çŸ¥ã£ã¦ã„ã‚‹ã“ã¨ã¯åŸºæœ¬çš„ã«ãªã„ã€‚

```{r, echo=FALSE}
set.seed(123)
n <- 10000
theta <- 0.7
k_values <- c(1, 10, 50, 100)
plots <- list()

for (k in k_values) {
  data <- rbinom(n = n, size = k, prob = theta)
  
  p <- ggplot(data.frame(x = data/k), aes(x)) + 
    geom_histogram(aes(y = after_stat(count / sum(count))), bins = 30, 
                   fill = "skyblue", color = "black", alpha = 0.7) +
    ggtitle(paste("Binomial Distribution (k =", k, ")")) +
    theme_minimal() +
    scale_x_continuous(labels = scales::label_comma()) +
    scale_y_continuous(labels = scales::percent_format(accuracy = 1)) # â† %è¡¨ç¤ºã«ã™ã‚‹
  plots[[length(plots) + 1]] <- p
}

# 4ã¤ã‚’ä¸¦ã¹ã¦è¡¨ç¤º
plots[[1]] + plots[[2]] + plots[[3]] + plots[[4]]
```


## åŒºé–“æ¨å®šã®è€ƒãˆæ–¹
### æ¯é›†å›£åˆ†å¸ƒã«ç¢ºç‡åˆ†å¸ƒã‚’ä»®å®šã™ã‚‹
- æ¯é›†å›£åˆ†å¸ƒãŒæœªçŸ¥ã®å ´åˆã€æ¯é›†å›£ã‹ã‚‰ã‚ã‚‹å€¤ãŒæ¨™æœ¬ã¨ã—ã¦é¸ã°ã‚Œã‚‹äº‹è±¡ã®ç¢ºç‡ãŒã€‚ã‚ˆãçŸ¥ã‚‰ã‚ŒãŸç¢ºç‡åˆ†å¸ƒã«å¾“ã†ã¨ä»®å®šã™ã‚‹ã€‚

  - çµ±è¨ˆãƒ¢ãƒ‡ãƒ«ï¼ˆstatistical modelï¼‰ã‚„ç¢ºç‡ãƒ¢ãƒ‡ãƒ«ï¼ˆprobabilistic modelï¼‰ã¨å‘¼ã¶
  
  - ã‚ˆãçŸ¥ã‚‰ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ã¨ã—ã¦ã€**æ­£è¦åˆ†å¸ƒï¼ˆnormal distributionï¼‰**ãŒæŒ™ã’ã‚‰ã‚Œã‚‹

- é©åˆ‡ãªç¢ºç‡ãƒ¢ãƒ‡ãƒ«ã‚’è¨­å®šã—ãªã‘ã‚Œã°ã€ãã“ã‹ã‚‰ç®—å‡ºã—ãŸãƒ‡ãƒ¼ã‚¿ã¯æ­£ç¢ºã§ã¯ãªã„ã€‚

  - ã‚ã‚‹ç¨‹åº¦å¤§ãã„ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šã€ãã®ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã‚’æç”»ã—ã¦å½¢çŠ¶ã‚’ç¢ºèªã™ã‚‹
  
  - ãƒ‡ãƒ¼ã‚¿ã®ç™ºç”Ÿãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‹ã‚‰é¸ã¶
    
    - ä¾‹. åå¿œé€Ÿåº¦ã¯å¯¾æ•°æ­£è¦åˆ†å¸ƒã§è¿‘ä¼¼ã™ã‚‹ã€ç™ºç”Ÿç¢ºç‡ã®ä½ã„å‡ºæ¥äº‹ã¯ãƒãƒ¯ã‚½ãƒ³åˆ†å¸ƒã«è¿‘ä¼¼ã™ã‚‹

### æ­£è¦åˆ†å¸ƒã®æ€§è³ª
- ç¢ºç‡åˆ†å¸ƒã¯å½¢çŠ¶ã‚’æ±ºã‚ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒã‚ã‚‹ã€‚

- æ­£è¦åˆ†å¸ƒã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼šå¹³å‡ï¼ˆç¢ºç‡åˆ†å¸ƒã®ä½ç½®ï¼‰ + åˆ†æ•£ï¼ˆç¢ºç‡åˆ†å¸ƒã®åºƒãŒã‚Šï¼‰

  - æœŸå¾…å€¤ï¼ˆExpected valueï¼‰ï¼šç¢ºç‡åˆ†å¸ƒã®å¹³å‡å€¤ã®ã“ã¨

```{r, echo=FALSE, warning=FALSE, message=FALSE}
# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®è¨­å®š
mu_values <- c(0, 0, 0, -2)  # å¹³å‡ (0, 2, -2, 0)
sigma_values <- c(0.2, 1, 5, 2)  # æ¨™æº–åå·® (1, 1, 1, 2)

# xè»¸ã®ç¯„å›²ã‚’è¨­å®š
x <- seq(-10, 10, length.out = 1000)

# ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ä½œæˆã—ã¦ggplotã§æç”»
data <- data.frame(
  x = rep(x, 4), 
  y = c(dnorm(x, mean = mu_values[1], sd = sigma_values[1]), 
        dnorm(x, mean = mu_values[2], sd = sigma_values[2]), 
        dnorm(x, mean = mu_values[3], sd = sigma_values[3]), 
        dnorm(x, mean = mu_values[4], sd = sigma_values[4])),
  distribution = rep(c("mu=0, sigma=0.2", "mu=0, sigma=1", "mu=0, sigma=5", "mu=-2, sigma=2"), each = length(x))
)

# ggplotã§æ­£è¦åˆ†å¸ƒæ›²ç·šã‚’æç”»
ggplot(data, aes(x = x, y = y, linetype = distribution)) + 
  geom_line(size = 1) +
  labs(title = "Different Normal Distributions", 
       x = "x", 
       y = "Density") +
  theme_minimal() 
```

- ç¢ºç‡å¤‰æ•°ãŒé›¢æ•£çš„ãªå€¤ã‚’ã¨ã‚‹å ´åˆã€ç¢ºç‡å¤‰æ•°ã®å®Ÿç¾å€¤ã¨ç¢ºç‡ã¯ä¸€å¯¾ä¸€å¯¾å¿œã—ã¦ã„ã‚‹ï¼ˆä¾‹ 1ã‹0ã®ãƒ‡ãƒ¼ã‚¿ï¼‰ã€‚

  - ä¾‹ï¼‰ä¸‹è¨˜å›³ã®ã‚ˆã†ã«10å›ç¹°ã‚Šè¿”ã—ãŸå ´åˆã€

    - æˆåŠŸæ•°ï¼ˆ5å›ï¼‰ => ç¢ºç‡10%

    - æˆåŠŸæ•°ï¼ˆ6å›ï¼‰ => ç¢ºç‡20%

```{r, echo=FALSE, warning=FALSE, message=FALSE}
# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š
set.seed(123)
n <- 10000  # ä¹±æ•°ã®å€‹æ•°
size <- 10   # è©¦è¡Œå›æ•°
prob <- 0.7  # æˆåŠŸç¢ºç‡

# 2é …åˆ†å¸ƒã«å¾“ã†ä¹±æ•°ã®ç”Ÿæˆ
data <- rbinom(n, size, prob)

# ggplotã§ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã‚’ä½œæˆ
ggplot(data.frame(x = data), aes(x = x)) + 
  geom_histogram(binwidth = 1, fill = "skyblue", color = "black", aes(y = ..density..)) + 
  labs(title = "Binomial Distribution (Size = 10, p = 0.7)",
       x = "Number of Successes",
       y = "Density (Probability)") +
  theme_minimal() +
  scale_x_continuous(breaks = seq(0, size, by = 1)) 

```

- ç¢ºç‡å¤‰æ•°ãŒé€£ç¶šçš„ãªå€¤ã‚’ã¨ã‚‹å ´åˆã€å®Ÿç¾å€¤ã®å€¤ã§ã¯ãªãã€ãã®**ç¯„å›²ã¨ç¢ºç‡**ãŒå¯¾å¿œã™ã‚‹ã€‚ã¤ã¾ã‚Šã€ç¢ºç‡åˆ†å¸ƒã®**é¢ç©ãŒç¢ºç‡ã¨å¯¾å¿œã™ã‚‹**ï¼ˆæ•°å€¤ç©åˆ†ã‚’ã—ã¦æ±‚ã‚ãªã„ã¨ã„ã‘ãªã„ï¼‰ã€‚

```{r, echo=FALSE}
set.seed(123)
n <- 100000  # ä¹±æ•°ã®å€‹æ•°

data <- data.frame(value = rnorm(n, mean = 0, sd = 1))

# å¯†åº¦æ¨å®š
density_data <- density(data$value)
density_df <- data.frame(x = density_data$x, y = density_data$y)

# ggplotã§æç”»
ggplot(density_df, aes(x = x, y = y)) +
  geom_line(color = "black") +  # å¯†åº¦æ›²ç·š
  geom_ribbon(data = subset(density_df, x >= 0 & x <= 1), 
              aes(ymin = 0, ymax = y), 
              fill = "skyblue", alpha = 0.7) +  # xãŒ0ã‹ã‚‰1ã®ç¯„å›²ã‚’å¡—ã‚Šã¤ã¶ã—
  labs(title = "é’ã§å¡—ã‚‰ã‚Œã¦ã„ã‚‹ã®ã¯0ã‹ã‚‰1ã®ç¯„å›²",
       x = "Value",
       y = "Density") +
  theme_minimal()
```

- ç©åˆ†ã™ã‚‹é–¢æ•°```integrate```ã‚’ç”¨ã„ã¦ã€å¹³å‡0ã€åˆ†æ•£1ã®æ­£è¦åˆ†å¸ƒã®å®Ÿç¾å€¤ãŒ0ã‹ã‚‰1ã®ç¯„å›²ã‚’æ±‚ã‚ã‚‹ã€‚ãã®çµæœã¯ãŠã‚ˆã34.1%ã«ãªã‚‹ã€‚

```{r}
stats::integrate(f = dnorm, lower = 0, upper = 1)
```

::: infobox
absolute errorã¯ã€è¨ˆç®—ã«ãŠã‘ã‚‹èª¤å·®ã§ã™ã€‚```integrate```é–¢æ•°ã¯**æ•°å€¤ç©åˆ†**ã‚’è¡Œã„ã¾ã™ãŒã€ã“ã®æ–¹æ³•ã§ç©åˆ†ã•ã‚ŒãŸçµæœã¯ç†è«–ä¸Šæ­£ã—ã„çµæœã¨ã‚ºãƒ¬ï¼ˆèª¤å·®ï¼‰ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®ã‚ºãƒ¬ãŒæ­£è² ç„¡è¦–ã—ã¦ã©ã‚Œãã‚‰ã„ã‚ã‚‹ã‹ã®æ•°å€¤ã§ã™ã€‚
:::

- å¹³å‡å€¤ Â± **1.96** Ã— æ¨™æº–åå·®ã§ã€æ¨™æœ¬åˆ†å¸ƒã®95%ã®ç¯„å›²ã«ãªã‚‹ã€‚

- ç™½ã„éƒ¨åˆ†ã¯äºŒã‹æ‰€åˆã‚ã›ã¦ãƒ‡ãƒ¼ã‚¿ã®5%
```{r, echo=FALSE, warning=FALSE, message=FALSE}
set.seed(123)
n <- 100000  # ä¹±æ•°ã®å€‹æ•°

data <- data.frame(value = rnorm(n, mean = 0, sd = 1))

# å¯†åº¦æ¨å®š
density_data <- density(data$value)
density_df <- data.frame(x = density_data$x, y = density_data$y)

mean(density_data$x) + 1.96

# ggplotã§æç”»
ggplot(density_df, aes(x = x, y = y)) +
  geom_line(color = "black") +  # å¯†åº¦æ›²ç·š
  geom_ribbon(data = subset(density_df, x >= mean(density_data$x) - 1.96 & x <= mean(density_data$x) + 1.96), 
              aes(ymin = 0, ymax = y), 
              fill = "skyblue", alpha = 0.7) +  # xãŒ0ã‹ã‚‰1ã®ç¯„å›²ã‚’å¡—ã‚Šã¤ã¶ã—
  labs(title = "é’ã§å¡—ã‚‰ã‚Œã¦ã„ã‚‹ã®ã¯åˆ†å¸ƒã®95%",
       x = "Value",
       y = "Density") +
  theme_minimal()
```
- ```mean(density_data$x) Â± 1.96```ã¨ãªã£ã¦ã„ã‚‹ã®ã¯ã€æ¨™æº–åå·®ãŒ1ã§ã‚ã‚‹ãŸã‚ã€‚
```{r}
integrate(f = dnorm, lower = mean(density_data$x) - 1.96, upper = mean(density_data$x) + 1.96)
```

### ç¢ºç‡ãƒ¢ãƒ‡ãƒ«ã‚’ç”¨ã„ãŸæ¨å®š
- **é©åˆ‡ãªç¢ºç‡ãƒ¢ãƒ‡ãƒ«ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã¨ã**ã€æ¯æ•°ã‚’æ¨å®šã™ã‚‹ã“ã¨ã¯ã€ç¢ºç‡ãƒ¢ãƒ‡ãƒ«ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒã©ã®ã‚ˆã†ãªå€¤ã§ã‚ã‚‹ã‹ã‚’æ¨æ¸¬ã™ã‚‹ã“ã¨ã¨åŒã˜ã€‚

### æ­£è¦åˆ†å¸ƒãƒ¢ãƒ‡ãƒ«ã«ãŠã‘ã‚‹æ¨™æœ¬å¹³å‡ã®æ¨™æœ¬åˆ†å¸ƒ

- **æ¨™æº–èª¤å·®ï¼ˆStandard Error: *SE*ï¼‰**

  - æ¨™æœ¬åˆ†å¸ƒã®æ¨™æº–åå·®
  
$$
SE = \frac{\sigma}{\sqrt{n}}
$$

- *n* = æ¨™æœ¬ã‚µã‚¤ã‚º 

  - æ¨™æœ¬ã‚µã‚¤ã‚ºãŒå¤§ãã„ã»ã©æ¨™æº–èª¤å·®ã¯å°ã•ããªã‚Šã€æ¨™æœ¬å¹³å‡ã¯æ¯å¹³å‡ã«è¿‘ã¥ãï¼ˆåˆ†æ¯ã«æ¨™æœ¬ã‚µã‚¤ã‚ºï¼‰

### åŒºé–“æ¨å®š
- **ç‚¹æ¨å®šï¼ˆpoint estimationï¼‰**ï¼šå¹³å‡å€¤ã®ã‚ˆã†ã«1ã¤ã®å€¤ã«ã‚ˆã£ã¦æ¯æ•°ï¼ˆæ¯å¹³å‡ãªã©ï¼‰ã‚’æ¨å®šã™ã‚‹ã“ã¨

  - æ¨™æœ¬ã‚µã‚¤ã‚ºãŒã©ã‚Œã ã‘å¤§ããã¦ã‚‚ã€æ¨™æœ¬å¹³å‡ã¯ç¢ºç‡çš„ã«å¤‰å‹•ã™ã‚‹ãŸã‚ã€ãšã°ã‚Šæ¯æ•°ã‚’å½“ã¦ã‚‹ã“ã¨ã¯é›£ã—ã„

#### ä¿¡é ¼åŒºé–“

- **åŒºé–“æ¨å®šï¼ˆinterval estimationï¼‰**ï¼šåŒºé–“ã«ã‚ˆã‚‹æ¨å®šã‚’è¡Œã†ã“ã¨

  - å¿…ãšã“ã®åŒºé–“ã«å½“ã¦ã¯ã¾ã‚‹ã“ã¨ã¯ä¸»å¼µã§ããªã„ã€‚ãã®ãŸã‚ã€åŒºé–“æ¨å®šã§ã¯ã€**ä¿¡é ¼åº¦ï¼ˆdegree of confidenceï¼‰**ã‚’è¨­å®šã™ã‚‹ã€‚ã“ã‚Œã‚’**ä¿¡é ¼åŒºé–“ï¼ˆconfidence intervalï¼‰**ã¨ã„ã†ã€‚
  
    - è¨€èªç ”ç©¶ã®åˆ†é‡ã§ã¯95%ãŒä¸€èˆ¬çš„

##### æ¯åˆ†æ•£ã‚’äº‹å‰ã«çŸ¥ã£ã¦ã„ã‚‹å ´åˆ

- æ¨™æœ¬ã‚µã‚¤ã‚ºã¯25ã€æ¨™æœ¬å¹³å‡99.46ã€æ¯åˆ†æ•£ã¯4ã‚’ä¾‹ã¨ã™ã‚‹ã€‚ã‚ˆã£ã¦æ¨™æº–èª¤å·®ã¯0.4ã€‚

  - ã€Œå¾—ã‚‰ã‚ŒãŸæ¨™æœ¬çµ±è¨ˆé‡ãŒ95%ã®ä¿¡é ¼åº¦ã§å¦å®šã•ã‚Œãªã„æ¯æ•°ã®ç¯„å›²ã€ã‚’è€ƒãˆã‚‹ => æ¨™æœ¬å¹³å‡99.46ãŒ95%ä¸Šé™ãã‚Šãã‚Šã«ãªã‚‹ã‚ˆã†ãªæ¯æ•°ã¨ã€95%ä¸‹é™ãã‚Šãã‚Šã«ãªã‚‹ã‚ˆã†ãªæ¯æ•°ã®ç¯„å›²ã€‚ä¸Šè¨˜ã§æ‰±ã£ãŸã‚ˆã†ã«ã€é¢ç©ã®95%ã‚’å¡—ã‚Šã¤ã¶ã™ã«ã¯ã€å¹³å‡å€¤ã‹ã‚‰ Â± 1.96 Ã— æ¨™æº–åå·®ã™ã‚Œã°ã‚ˆã„ã€‚
  
  - ä¸‹é™ï¼š99.46 - 1.96 Ã— 0.4 = 98.68
  - ä¸Šé™ï¼š99.46 + 1.96 Ã— 0.4 = 100.24

    - ä¸‹è¨˜ã®å›³ã®èµ¤ã„ç‚¹ç·šã®å†…å´ã®ç¯„å›²ãŒ95%ä¿¡é ¼åŒºé–“
```{r, echo=FALSE}
set.seed(123)

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š
mean1 <- 98.68  # ç¬¬ä¸€ã®å¹³å‡
mean2 <- 100.24 # ç¬¬äºŒã®å¹³å‡
sd_val <- 0.4     # æ¨™æº–åå·®ï¼ˆä»®å®šï¼‰

# x è»¸ã®ç¯„å›²ã‚’è¨­å®š
x_vals <- seq(mean1 - 1.96*sd_val, mean2 + 1.96*sd_val, length.out = 200)

# æ­£è¦åˆ†å¸ƒã®å¯†åº¦é–¢æ•°ã‚’è¨ˆç®—
data <- data.frame(
  x = rep(x_vals, 2),
  y = c(dnorm(x_vals, mean = mean1, sd = sd_val), 
        dnorm(x_vals, mean = mean2, sd = sd_val)),
  distribution = rep(c("Mean = 98.68", "Mean = 100.24"), each = length(x_vals))
)

x <- data %>%
  dplyr::filter(distribution == "Mean = 98.68") %>%
ggplot(aes(x = x, y = y)) +
  geom_line(size = 1) +
  labs(title = "Mean = 98.68",
       x = "Value",
       y = "Density") +
  geom_vline(xintercept = mean1, linetype = "dashed", color = "red") +  # ä¸‹é™
  geom_vline(xintercept = (mean1 + mean2)/2, linetype = "solid", color = "black") + # æ¨™æœ¬å¹³å‡
  #geom_ribbon(data = subset(data, x >= mean1 - 1.96*sd_val & x <= mean1 + 1.96*sd_val), 
  #            aes(ymin = 0, ymax = y), fill = "skyblue", alpha = 0.7) +
  theme_minimal()

y <- data %>%
  dplyr::filter(distribution == "Mean = 100.24") %>%
ggplot(aes(x = x, y = y)) +
  geom_line(size = 1) +
  labs(title = "Mean = 100.24",
       x = "Value",
       y = "Density") +
  geom_vline(xintercept = mean2, linetype = "dashed", color = "red") +  # ä¸‹é™
  geom_vline(xintercept = (mean1 + mean2)/2, linetype = "solid", color = "black") + # æ¨™æœ¬å¹³å‡
  #geom_ribbon(data = subset(data, x >= mean2 - 1.96*sd_val & x <= mean2 + 1.96*sd_val), 
  #            aes(ymin = 0, ymax = y), fill = "skyblue", alpha = 0.7) +
  theme_minimal()

# æç”»
z <- ggplot(data, aes(x = x, y = y, color = distribution, linetype = distribution)) +
  geom_line(size = 1) +
  labs(title = "Comparison of Two Normal Distributions",
       x = "Value",
       y = "Density") +
  scale_color_manual(values = c("black", "black")) +
  geom_vline(xintercept = mean1, linetype = "dashed", color = "red") +  # ä¸‹é™
  geom_vline(xintercept = mean2, linetype = "dashed", color = "red") +  # ä¸Šé™
  geom_vline(xintercept = (mean1 + mean2)/2, linetype = "solid", color = "black") + # æ¨™æœ¬å¹³å‡
  theme_minimal() +
  theme(legend.position = "none")  # â† å‡¡ä¾‹ã‚’éè¡¨ç¤º  

x + y - z + plot_layout(ncol = 1)
```


##### æ¯åˆ†æ•£ã‚’çŸ¥ã‚‰ãªã„å ´åˆ

- æ¯åˆ†æ•£ãŒåˆ†ã‹ã‚‰ãªã„å ´åˆã®æ¯å¹³å‡ã®æ¨å®šæ–¹æ³•ã‚’æ‰±ã†ã€‚ç¾å®Ÿçš„ã«ã€æ¯åˆ†æ•£ãŒåˆ†ã‹ã£ã¦ã„ã‚‹ã“ã¨ã¯ã»ã¨ã‚“ã©ãªã„ã€‚

- æ¯åˆ†æ•£ãŒåˆ†ã‹ã‚‰ãªã„å ´åˆã€ä¸Šè¨˜ã®ç®—å‡ºæ³•ã§ã¯æ¯å¹³å‡ã®åŒºé–“æ¨å®šã¯ã§ããªã„ã€‚å¾“ã£ã¦ã€æ¯åˆ†æ•£ã«ä¾å­˜ã—ãªã„çµ±è¨ˆé‡ã®è¨ˆç®—ãŒå¿…è¦ã¨ãªã‚‹

###### *t* å€¤ã‚’ç”¨ã„ãŸä¿¡é ¼åŒºé–“ã®è¨ˆç®—
- ***t* å€¤**ï¼šä¸‹è¨˜ã®å¼ã‹ã‚‰ç®—å‡ºã§ãã‚‹å€¤ã€‚*t*åˆ†å¸ƒã«å¾“ã†ã€‚

\[
t = \frac{\bar{x} - \mu}{\frac{u^2}{\sqrt{n}}}
\]


  - *t*åˆ†å¸ƒã«ã¯ã€**è‡ªç”±åº¦ï¼ˆdegree of freedomï¼‰**ã¨å‘¼ã°ã‚Œã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒã‚ã‚‹ã€‚*t*åˆ†å¸ƒã®è‡ªç”±åº¦ã¯ã€æ¨™æœ¬ã‚µã‚¤ã‚ºã«ã‚ˆã£ã¦å¤‰ã‚ã‚‹ã€‚è‡ªç”±åº¦ã¯ã€ *n* - 1ã§è¨ˆç®—ã§ãã‚‹ã€‚
  - è‡ªç”±åº¦ãŒ100ãã‚‰ã„ã«ãªã‚‹ã¨ã€æ¨™æº–æ­£è¦åˆ†å¸ƒï¼ˆå¹³å‡0, æ¨™æº–åå·®1ã®æ­£è¦åˆ†å¸ƒï¼‰ã¨åŒã˜ã‚ˆã†ãªå½¢ã«ãªã‚‹ã€‚

- æ¯å¹³å‡ãŒåˆ†ã‹ã‚‰ãªã„å ´åˆã€ä¸Šè¨˜ã®*t*å€¤ã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ã¯ã§ããªã„ã€‚ã—ã‹ã—ã€æ¯å¹³å‡ã®ä¿¡é ¼åŒºé–“ã‚’æ±‚ã‚ã‚‹å ´åˆã€*t*åˆ†å¸ƒã®95%ã®é¢ç©ã«ã‚ã‚ã‚‹ã‚ˆã†ãªç¯„å›²ã‚’è€ƒãˆã‚Œã°ã„ã„ã€‚è‡ªç”±åº¦25ã®æ™‚ã€ä¸Šå´ã¨ä¸‹å´ãã‚Œãã‚Œ2.5%ï¼ˆ5% Ã· 2ï¼‰ã¨ãªã‚‹ã‚ˆã†ãª*t*å€¤ã‚’æ±‚ã‚ã‚‹ï¼ˆè¡¨ã‹ã‚‰å€¤ã‚’æ¢ã—ãŸã‚Šã—ã¦å€¤ã‚’è¦‹ã¤ã‘ã‚‹ï¼‰ã€‚

- Rã®æ¨™æº–çš„ãªé–¢æ•°ã§æ±‚ã‚ã‚‹ã“ã¨ã‚‚å¯èƒ½
```{r}
qt(.975, df = 24)
qt(.025, df = 24)
```

ä»¥ä¸‹ã®å¼ã‚’ã‚‚ã¨ã«ç®—å‡ºã™ã‚‹
  
\[
\left( \bar{x} - t_{\alpha/2, \, n-1} \cdot \frac{u^2}{\sqrt{n}}, \quad \bar{x} + t_{\alpha/2, \, n-1} \cdot \frac{u^2}{\sqrt{n}} \right)
\]


- *u^2*ã¯ä¸ååˆ†æ•£ã§ã‚ã‚Šã€ä»¥ä¸‹ã®å¼ã§æ±‚ã‚ã‚‰ã‚Œã‚‹ã€‚è‡ªç”±åº¦25ã€æ¨™æº–åå·®ãŒ2.24ã®å ´åˆã€*n*ã«25ã€*S*ã«2.24ã‚’ä»£å…¥ã™ã‚‹ã€‚ã—ã‹ã—ã€æ¨™æœ¬ã‚µã‚¤ã‚ºãŒå¤§ãã„ã¨ãã¯ã»ã¨ã‚“ã©åŒã˜å€¤ã«ãªã‚‹ãŸã‚ã€å®Ÿç”¨ä¸Šæ¨™æœ¬åˆ†æ•£ã‚’ç”¨ã„ã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã€‚

\[
s^2 = \frac{1}{n-1}S^2
\]

- ä¸Šé™ï¼š99.46 + 2.06 * sqrt\left\{\frac{5.23}{25}\right\}
- ä¸‹é™ï¼š99.46 - 2.06 * sqrt\left\{\frac{5.23}{25}\right\}

  - 98.52 - 100.40ã®é–“ã«æ¯å¹³å‡ãŒã‚ã‚‹ã¨æ¨å®šã•ã‚ŒãŸ

## Rã®é–¢æ•°ã§95%ä¿¡é ¼åŒºé–“ã‚’æ±‚ã‚ã‚‹

```{r}
gmodels::ci(mtcars$mpg)
```

- cié–¢æ•°ã¨ä¸€è‡´ã—ãŸ
```{r}
mean(mtcars$mpg) + qt(df = (nrow(mtcars)-1), .025) * sd(mtcars$mpg)/sqrt(nrow(mtcars))
mean(mtcars$mpg) + qt(df = (nrow(mtcars)-1), .975) * sd(mtcars$mpg)/sqrt(nrow(mtcars))
```

::: infobox

**ä¸ååˆ†æ•£ã®ä¸åã¨ã¯**
ã€€æ¨æ¸¬çµ±è¨ˆå­¦ã§ã¯**ä¸€è‡´æ€§ï¼ˆconsistencyï¼‰**ã€**ä¸åæ€§ï¼ˆunbiasednessï¼‰**ã€**æœ‰åŠ¹æ€§ï¼ˆefficiencyï¼‰**ã¨ã„ã†æ¦‚å¿µãŒé‡è¦ã¨ãªã‚Šã¾ã™ã€‚è©³ã—ã„èª¬æ˜ã¯åˆ¥ã®æ©Ÿä¼šã«è¡Œã„ã¾ã™ãŒã€ä¸ååˆ†æ•£ã¯ä¸åæ€§ã‚’ã‚‚ã¤æ¨å®šé‡ã®ã“ã¨ã‚’è¡¨ã—ã¾ã™ã€‚ä¸åæ€§ã¨ã¯æ¨å®šé‡ã®æœŸå¾…å€¤ãŒæ¯æ•°ã¨ä¸€è‡´ã™ã‚‹æ€§è³ªã«ãªã‚Šã¾ã™ã€‚æ¨™æœ¬å¹³å‡ã¯ä¸åæ¨å®šé‡ã§ã™ãŒã€æ¨™æœ¬åˆ†æ•£ã€æ¨™æœ¬æ¨™æº–åå·®ã¯ä¸åæ¨å®šé‡ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã¤ã¾ã‚Šã€æ¯åˆ†æ•£ã¨æ¨™æœ¬åˆ†æ•£ã«ã¯ã‚ºãƒ¬ãŒå­˜åœ¨ã—ã¾ã™ã€‚ã“ã®ã‚ºãƒ¬ã‚’èª¿ç¯€ã™ã‚‹ãŸã‚ã€n - 1ã§åå·®äºŒä¹—å’Œã‚’å‰²ã£ã¦ã„ã¾ã™ï¼ˆå‰²ã‚‹æ•°ãŒ-1ã ã‘æ¸›ã‚‹ã®ã§ã€æ¨™æœ¬åˆ†æ•£ã‚ˆã‚Šå°‘ã—å¤§ãããªã‚‹ï¼‰ã€‚
:::

## ãƒãƒ³ã‚ºã‚ªãƒ³ã‚»ãƒƒã‚·ãƒ§ãƒ³

### ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
- å…ˆé€±ã®è¬›ç¾©ã§é…å¸ƒã€‚
```{r}
dat <- read.csv("../stat_class_2025/sample_data/pokemon_data.csv")
```

#### ãƒ‡ãƒ¼ã‚¿ã®ä¸­èº«ã‚’ç¢ºèª
```{r}
summary(dat)
```

```{r}
head(dat)
```

### ç¢ºç‡åˆ†å¸ƒã‚’é¸ã¶

#### ãƒ‡ãƒ¼ã‚¿ã®å¯è¦–åŒ–
```{r}
hist(dat$ã“ã†ã’ã)
```

#### æ­£è¦åˆ†å¸ƒã‚’ã‚ã¦ã¯ã‚ã¦ã¿ã‚‹
```{r}
# xè»¸ã®ç¯„å›²ã‚’æ±ºå®š
x <- seq(min(dat$ã“ã†ã’ã), max(dat$ã“ã†ã’ã), length.out = nrow(dat)) 
#min(dat$ã“ã†ã’ã) ã‹ã‚‰ max(dat$ã“ã†ã’ã) ã¾ã§ã€ãƒ‡ãƒ¼ã‚¿ã®æ•° (nrow(dat)) ã ã‘ ç­‰é–“éš” ã«åŒºåˆ‡ã£ãŸå€¤ã‚’ x ã«å…¥ã‚Œã‚‹ã€‚ã“ã‚Œã‚’ä½¿ã£ã¦ã€ãªã‚ã‚‰ã‹ãªæ›²ç·šã‚’æç”»ã™ã‚‹ãŸã‚ã®åŸºæº–ç‚¹ã‚’ä½œã‚‹

# ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã‚’ç¢ºç‡å¯†åº¦ã§æç”»
hist(dat$ã“ã†ã’ã, probability = TRUE)
#probability = TRUE ã‚’æŒ‡å®šã™ã‚‹ã¨ã€ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã® yè»¸ãŒã€Œç¢ºç‡å¯†åº¦ã€ã«ãªã‚‹ã€‚åˆ†å¸ƒã‚’ã‚ã¦ã¯ã‚ã‚‹ã¨ãã¯ã€ã“ã®è¨­å®šã‚’ã—ãªã„ã¨å½“ã¦ã¯ã¾ã‚‰ãªã„ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼ˆprobability = FALSEï¼‰ã§ã¯ã€Œåº¦æ•°ã€ï¼ˆãƒ‡ãƒ¼ã‚¿ã®æ•°ï¼‰ã«ãªã‚‹

# æ­£è¦åˆ†å¸ƒã®ç¢ºç‡å¯†åº¦é–¢æ•°ã‚’æç”»
#ã€Œãƒ‡ãƒ¼ã‚¿ã®åˆ†å¸ƒãŒ ã‚‚ã—æ­£è¦åˆ†å¸ƒã«å¾“ã£ã¦ã„ãŸã‚‰ ã©ã‚“ãªå½¢ã«ãªã‚‹ã‹ï¼Ÿã€ã‚’ã€ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã®ä¸Šã«æãã€‚
#dnorm() ã¯ æ­£è¦åˆ†å¸ƒ ã®ç¢ºç‡å¯†åº¦é–¢æ•°ã‚’è¨ˆç®—ã™ã‚‹ã€‚
#å¹³å‡ (mean(dat$ã“ã†ã’ã)) ã¨ æ¨™æº–åå·® (sd(dat$ã“ã†ã’ã)) ã‚’ä½¿ã£ã¦ ã€Œç†æƒ³çš„ãªæ­£è¦åˆ†å¸ƒã€ ã®å½¢ã‚’ä½œã‚‹ã€‚lwd = 2ã§ç·šã®å¤ªã•ã‚’å°‘ã—å¤ªãã™ã‚‹
lines(x, dnorm(x, mean = mean(dat$ã“ã†ã’ã), sd = sd(dat$ã“ã†ã’ã)), lwd = 2)
```

### æ¯åˆ†æ•£æœªçŸ¥ã®æ¯å¹³å‡ã®95%ä¿¡é ¼åŒºé–“ã‚’æ±‚ã‚ã‚‹

- æ¯å¹³å‡ã‚’å¾—ã‚‰ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æ¨å®šã—ã‚ˆã†

  - ãƒã‚±ãƒ¢ãƒ³ã®ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã€cié–¢æ•°ã¨qté–¢æ•°ã§95%ä¿¡é ¼åŒºé–“æ±‚ã‚ã¦ã¿ã‚ˆã†ã€‚
  
    - qté–¢æ•°ã§ã¯ã€*t*å€¤ã‚’ä½¿ã„ã€å¼ã‚’ä½œã£ã¦è¨ˆç®—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™

### cié–¢æ•°
- ä»Šå›ã®è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ç„¡è¦–ã—ã¦OKï¼ˆ[å‚è€ƒ](https://stackoverflow.com/questions/64507040/calculating-confidence-interval-using-ci-function)ï¼‰
```{r}
#install.packages("gmodels")
library(gmodels)
ci(dat$ã“ã†ã’ã)
```

### qté–¢æ•°
- å¿…è¦ãªãƒ‘ãƒ¼ãƒ„ï¼šå¹³å‡å€¤ã€*t*å€¤ã€æ¨™æœ¬æ¨™æº–åå·®ï¼ˆæœ¬å½“ã¯$\sqrt{\text{ä¸ååˆ†æ•£}}$ = ä¸åæ¨™æº–åå·®ï¼‰ã€ã‚µãƒ³ãƒ—ãƒ«æ•°

  - sdé–¢æ•°ã¯ã€æ¨™æº–åå·®ã‚’ç®—å‡ºã™ã‚‹é–¢æ•°ã ãŒã€åˆ†æ¯ã‚’n-1ã—ãŸå€¤ã‚’è¿”ã—ã¦ã„ã‚‹ï¼ˆ= ä¸åæ¨™æº–åå·®ï¼‰
```{r}
n <-  nrow(dat) #ã‚µãƒ³ãƒ—ãƒ«æ•°
m <- mean(dat$ã“ã†ã’ã) #å¹³å‡å€¤
t_value <- qt(df = n - 1, .975) #tå€¤
sd <- sd(dat$ã“ã†ã’ã)#æ¨™æœ¬æ¨™æº–åå·®

lower <- m - t_value * sd/sqrt(n) #ä¸‹é™
upper <- m + t_value * sd/sqrt(n) #ä¸Šé™

lower
upper
```

- ä¸‹é™ã¯ã“ã£ã¡ã§ã‚‚åŒã˜å€¤ã«ãªã‚‹
```{r}
t_value_low <- qt(df = n -1, .025)
lower2 <- m + t_value_low * sd/sqrt(n)

lower2
```

## æ¬¡é€±ã¾ã§ã®èª²é¡Œ

### èª²é¡Œå†…å®¹

1.  å°ãƒ†ã‚¹ãƒˆã«å‘ã‘ã¦ä»Šå›ã®å†…å®¹ã‚’å¾©ç¿’ã™ã‚‹ã€‚å¿…ãšæ‰‹ã§ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦Rã‚’å®Ÿè¡Œã™ã‚‹ã€‚

2.  ä¸‹è¨˜ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚‚ã¨ã«ã€ã©ã®æŒ‡æ¨™ã§ã‚‚ã‚ˆã„ã®ã§ã€ä»¥ä¸‹ã®å†…å®¹ã‚’å«ã‚ã‚‹ã“ã¨ã€‚ãŸã ã—ã€ãƒ‡ãƒ¼ã‚¿ã«ã¯é€£ç¶šã¨é›¢æ•£ã®ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹ã“ã¨ã«æ³¨æ„ã€‚ã¾ãŸã€ãƒã‚±ãƒ¢ãƒ³idã®ç®±ã²ã’å›³ã‚’æ±‚ã‚ã¦ã‚‚æ„å‘³ãŒãªã„ãªã©ã€ãƒ‡ãƒ¼ã‚¿ã®ç‰¹å¾´ã‚’è¸ã¾ãˆã¦åˆ†æã™ã‚‹ã“ã¨ã€‚

-   ãƒ‡ãƒ¼ã‚¿å†…ã®ã©ã®å¤‰æ•°ï¼ˆã“ã†ã’ãã€ã¼ã†ãã‚‡ãªã©ï¼‰ã§ã‚‚ã‚ˆã„ã®ã§ã€ç®±ã²ã’å›³ã¨ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã§ãƒ‡ãƒ¼ã‚¿ã‚’å¯è¦–åŒ–ã™ã‚‹

- ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã«æ­£è¦åˆ†å¸ƒã‚’ã‚ã¦ã¯ã‚ãŸå›³ã‚’æç”»ã™ã‚‹

- cié–¢æ•°ã¨qté–¢æ•°ã§ã“ã†ã’ãä»¥å¤–ã®å¤‰æ•°ã®95%ä¿¡é ¼åŒºé–“ã‚’ç®—å‡ºã™ã‚‹

  - ã©ã¡ã‚‰ã®é–¢æ•°ã‚‚å€¤ã¯ä¸€è‡´ã—ã¾ã™

- **ãƒ‡ãƒ¼ã‚¿ã®è©³ç´°ã¯å‰ã®ç« ã®ã€Œæ¬¡é€±ã¾ã§ã®èª²é¡Œã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‚ç…§**

### æå‡ºæ–¹æ³•

-   R Markdownãƒ•ã‚¡ã‚¤ãƒ«ã§ä½œæˆã—ã€HTMLãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ›ã—TACTã¸æå‡º
-   ç· ã‚åˆ‡ã‚Šã¯ä»Šé€±ã®æœ¨æ›œæ—¥23:59ã¾ã§

## å‚è€ƒæ–‡çŒ®

- ğŸ“šæ¸…æ°´ï¼ˆ2021ï¼‰ã€å¿ƒç†å­¦çµ±è¨ˆæ³• (æ”¾é€å¤§å­¦æ•™æ 1638)ã€æ”¾é€å¤§å­¦æ•™è‚²æŒ¯èˆˆä¼š
- ğŸ“šå¹³äº•ãƒ»å²¡ãƒ»è‰è–™ï¼ˆç·¨è‘—ï¼‰ï¼ˆ2022ï¼‰ ã€æ•™è‚²ãƒ»å¿ƒç†ç³»ç ”ç©¶ã®ãŸã‚ã®ï¼²ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿åˆ†æâ€•è«–æ–‡ä½œæˆã¸ã®ç†è«–ã¨å®Ÿè·µé›†ã€æ±äº¬å›³æ›¸
- ğŸ’»[ãƒã‚±ãƒ¢ãƒ³ã§å­¦ã¶ãƒ‡ãƒ¼ã‚¿åˆ†æï½œãƒ‡ãƒ¼ã‚¿ã®ä¸­èº«ã‚’çŸ¥ã‚ã†](https://smart-hint.com/poke-data/introduction/#%E3%83%9D%E3%82%B1%E3%83%A2%E3%83%B3%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%83%87%E3%83%BC%E3%82%BF%E5%88%86%E6%9E%90%E3%82%92%E5%AD%A6%E3%81%B6)

```{=html}
<style>
.infobox {
  padding: 1em 1em 1em 4em;
  margin-bottom: 10px;
  border: 2px solid orange;
  border-radius: 10px;
  background: #f5f5f5 5px center/3em no-repeat;
}

.beg {
  background-image: url("https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjHtu3kBX8P39WYBBAjar9c8c1ladK2SYL6_gEMXFweQfauWVhSvCQP5KELsPX5KNL1uOddLLQ-aeMxv904OW_NFFfANhBYObfBV09KO2EXehrb9kMdCLZY1afsChib-7zIkBJbG6OrbJpM/s400/aisatsu_kodomo_boy.png");}

.caution {
  background-image: url("https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhzMqkpQ7vLUKvumbm6AFwTLQiCe7tlDb2Q0MAiISLsesZHnhj0kbRjB4U3se3UrDIHfIy0hlahyphenhyphenQu-V2tOR2LcV_lX7U8P5a8jtqPYv3Ah4L-JoYi8PhoaoehumGIdp2vrsX0rRyhXqwA/s800/mark_chuui.png");}
  
</style>
```
